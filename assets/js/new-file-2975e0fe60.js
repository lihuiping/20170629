function transformRequest(t){var e="";for(var c in t)e+=encodeURIComponent(c)+"="+encodeURIComponent(t[c])+"&";return e}var conf=0,toke=token(),goodsList=["../assets/data/shopping-cart.json",baseUrl()+"index.php?r=cart&token="+toke],delGoods=["../assets/data/shopping-cart.json",baseUrl()+"index.php?r=cart&m=delCart&token="+toke],normsList=["../assets/data/goods-attr.json",baseUrl()+"index.php?r=cart&m=get_cart_goods_attr&token="+toke],couponsList=["../assets/data/coupons.json",baseUrl()+"index.php?r=Discount_coupon&m=getShopCoupon&token="+toke],couponList=["",baseUrl()+"index.php?r=User_discount_coupon&m=addUserCoupon"],editGoods=["",baseUrl()+"index.php?r=cart&m=editcart"],header={"content-type":"application/x-www-form-urlencoded"},vm=new Vue({el:"#shopping",data:{checked:[],shopcked:[],totalPrice:[],totalQcb:[],shoppingList:[],shopList:[],cartList:[],lists:[],goods:[],donation:!1},filters:{formatQcb:function(t,e){return e||(e=1),t*e},formatMoney:function(t,e){return e||(e=1),"￥"+(t*e).toFixed(2)}},mounted:function(){this.$nextTick(function(){vm.showView()})},computed:{totalMoney:function(t,e){for(var c=0,o=0;o<this.totalPrice.length;o++)c+=this.totalPrice[o];return c.toFixed(2)},totalQc:function(t,e){for(var c=0,o=0;o<this.totalQcb.length;o++)c+=this.totalQcb[o];return c},shopckAll:{get:function(){return this.checkedCount==this.lists.length},set:function(t){console.log(t);var e=this;t?(this.shopcked=this.lists.map(function(t,e){return t.shopid}),this.lists.forEach(function(t,e){}),e.shopcked.forEach(function(t,c){e.lists.forEach(function(e,c){e.shopid==t&&(e.checked=!0)})}),void 0===item.checked&&e.$set(item,"checked",!0)):this.lists.forEach(function(t,e){})}},shopCheck:{get:function(){return this.checkedCount==this.lists.length},set:function(t){console.log(t),t?this.checked=this.lists.map(function(t,e){var c=t.price*t.number,o=t.sell_price*t.number;return _this.totalPrice.push(c),_this.totalQcb.push(o),t.id}):this.lists.forEach(function(t,e){t.checked=!1})}},checkAll:{get:function(){return this.checkedCount==this.lists.length},set:function(t){var e=this;t?(this.totalPrice=[],this.totalQcb=[],this.checked=this.lists.map(function(t,c){var o=t.price*t.number,s=t.sell_price*t.number;return e.totalPrice.push(o),e.totalQcb.push(s),t.id}),console.log(this.checked)):(this.checked=[],this.totalPrice=[],this.totalQcb=[],this.lists.forEach(function(t,e){t.checked=!1}),this.shopList.forEach(function(t,e){console.log(t.shopcked),t.shopcked=!1}))}},checkedCount:{get:function(){return this.checked.length}}},methods:{showView:function(){var t=this;axios.get(goodsList[conf]).then(function(e){var c=e.data;t.$nextTick(function(){if(c&&"1"==c.res){t.shoppingList=c.data.able,t.shoppingList.forEach(function(e,c){return t.shopList.push(e),this.shopList}),t.shopList.forEach(function(e,c){return t.cartList.push(e.cartlist),t.goodsListData}),t.cartList.forEach(function(e,c){e.list.forEach(function(e,c){return t.lists.push(e),t.lists})});0===$(".ccart-shixiao").find("li").length&&$(".ccart-shixiao").remove()}else $.toast("操作失败")})})},currClick:function(t,e){var c=this;if(void 0===t.checked){this.$set(t,"checked",!0);var o=t.price*t.number,s=t.sell_price*t.number;this.totalPrice.push(o),this.totalQcb.push(s)}else t.checked=!t.checked,t.checked,this.totalPrice=[],this.totalQcb=[],this.lists.forEach(function(t,e){if(t.checked){var o=t.price*t.number,s=t.sell_price*t.number;c.totalPrice.push(o),c.totalQcb.push(s)}})},shopCheck:function(t,e){var c=this;void 0===t.checked?c.$set(t,"checked",!0):t.checked=!t.checked,console.log(t.checked),this.checked=t.cartlist.list.map(function(e,o){return void 0===e.checked?c.$set(e,"checked",t.checked):e.checked=t.checked,e.id})},changeMoney:function(t,e){var c=t.number,o=t.kucun;e>0?c<o?t.number++:(t.number=t.kucun,layer.open({content:"库存不足！",skin:"msg",time:1})):--t.number<1&&(t.number=1)},delGoods:function(t,e){var c=this;c.currentProduct=t;var o=c.currentProduct.id;c.currentProduct.shopid;"undefined"==c.currentProduct&&c.$set(t,"checked",!0),$.confirm("确认删除吗？",function(e){$.swipeoutClose("li.swipeout"),axios.post(delGoods[conf],transformRequest({ids:o,token:toke})).then(function(e){var o=e.data;if(o||"1"==o.res){if($("input[data-delcc="+t.id+"]").prop("checked")){var s=$("#ck_lenght").text(),i=$("#count_qcb").text(),n=$("#count_price").text(),r=t.sell_price*t.number,h=t.price*t.number;$("#count_qcb").text(i-h),$("#count_price").text((n-r).toFixed(2)),$("#ck_lenght").text(s-1),1==s&&$(".ccart-list").remove(),c.$nextTick(function(){vm.showView()}),$.toast("删除成功")}else{$(".count-price").length<=1&&($(".ccart-list").remove(),vm.showView()),c.$nextTick(function(){vm.showView()})}}else $.toast("删除失败")})})}}});