function ChkSonClick(e,t){for(var o=$(e),n=document.getElementById(t),a=0;a<o.length;a++)if(!o[a].checked)return void(n.checked=!1);n.checked=!0}function clIput(e){$(e).each(function(e,t){ChkSonClick($(this),"chkAll")})}function getgoodlist(){$.ajax({type:"get",async:!1,url:getgood[conf],cache:!1,dataType:"json",data:{token:token()},success:function(e){dataList=e;var t=$("#good li").length;t>"1"?$("#good").show():"0"!=dataList.res&&"0"!=t||($("#good").hide(),$(".no-good").removeClass("hidden"));new Vue({el:"#good",data:dataList,methods:{getTitleHref:function(e){return"goods-detail.html?id="+e}}})},error:function(){}})}function getshoplist(){$.ajax({type:"get",async:!1,url:getshop[conf],cache:!1,dataType:"json",data:{token:token()},success:function(e){dataList=e;var t=$("#shop li").length;t>"1"?$("#shop").show():"0"!=dataList.res&&"0"!=t||($("#shop").hide(),$(".no-shop").removeClass("hidden"));new Vue({el:"#shop",data:dataList,methods:{goodMessage:function(e){}}})},error:function(){}})}function cancel_good(e){var t=e.find("label").attr("for");$.ajax({type:"POST",url:del_good[conf],traditional:!0,data:{id:t,token:token()},cache:!1,success:function(t){layer.open({content:"已取消收藏所选商品",skin:"msg",time:2}),e.remove()},error:function(e){layer.open({content:"取消收藏所选商品失败",skin:"msg",time:2})}})}function cancel_business(e){var t=e.attr("for");$.ajax({type:"POST",url:del_business[conf],traditional:!0,data:{id:t,token:token()},cache:!1,success:function(t){layer.open({content:"已取消收藏所选商铺",skin:"msg",time:2}),e.parent().remove()},error:function(e){layer.open({content:"取消收藏所选商铺失败",skin:"msg",time:2})}})}var conf=1,getgood=["../assets/data/model.json",baseUrl()+"member.php?r=Fav_goods&m=findfav"],getshop=["../assets/data/shopmodel.json",baseUrl()+"member.php?r=Fav_business&m=findfav"],del_good=["../assets/data/shopmodel.json",baseUrl()+"member.php?r=Fav_goods&m=delfav"],del_business=["../assets/data/shopmodel.json",baseUrl()+"member.php?r=Fav_business&m=delfav"];$(function(){getgoodlist(),getshoplist(),$(".tabs input[name='my-radio']").on("click",function(e){clIput(".active input[name='my-radio']");var t=$(".tabs .active input[name='my-radio']:checked").length;$(".del_num").text(t)});var e=!1;$("#chkAll").on("click",function(){e?($("input[type='checkbox']").each(function(){this.checked=!1}),e=!1,$(".del_num").text("0")):($("input[type='checkbox']").each(function(){this.checked=!0}),e=!0,$(".del_num").text($(".active input[name='my-radio']:checked").length))}),$(".gooddel").on("click",function(){var e="";$(".tabs .active input[name='my-radio']:checked").each(function(t,o){""==e?e=$(o).attr("id"):e+=","+$(o).attr("id")}),"商品"==$(".bdbtm.active").text().trim()?$.ajax({type:"POST",url:del_good[conf],traditional:!0,data:{id:e,token:token()},cache:!1,success:function(e){var t=$(".tabs .active input[name='my-radio']:checked");t.length>0?(layer.open({content:"删除商品成功",skin:"msg",time:2}),t.parent().parent().remove(),getgoodlist()):(layer.open({content:"请选择删除的商品",skin:"msg",time:2}),$("del_num").text("0"))},error:function(e){layer.open({content:"删除商品失败",skin:"msg",time:2})}}):"商店"==$(".bdbtm.active").text().trim()&&$.ajax({type:"POST",url:del_business[conf],traditional:!0,data:{id:e,token:token()},cache:!1,success:function(e){var t=$(".tabs .active input[name='my-radio']:checked");t.length>0?(layer.open({content:"删除店铺成功",skin:"msg",time:2}),t.parent().parent().remove(),getshoplist()):(layer.open({content:"请选择删除的店铺",skin:"msg",time:2}),$("del_num").text("0"))},error:function(e){layer.open({content:"删除店铺失败",skin:"msg",time:2})}})}),$(".tabs").on("click",".cancelCollect",function(e){del_obj=$(e.currentTarget).parent().parent().parent();var t=$(del_obj.parent()).find("li").length,o=$(del_obj.parent().parent().parent()).find("li").length;"商品"==$(".bdbtm.active").text().trim()?(cancel_good(del_obj),t>"1"?$("#good").show():"1"==t&&($("#good").hide(),$(".no-good").removeClass("hidden"))):(cancel_business(del_obj),o>"1"?$("#shop").show():"1"==o&&($("#shop").hide(),$(".no-shop").removeClass("hidden")))}),"商品"==$(".bdbtm.active").text().trim()?0==$(".good li").length&&($(".no-good").show(),$(".editor").show(),$(".no-shop").hide(),$(".foot-all").hide(),$(".complete").hide()):"商店"==$(".bdbtm.active").text().trim()&&0==$(".shop li").length&&($(".no-shop").show(),$(".editor").show(),$(".no-good").hide(),$(".foot-all").hide(),$(".complete").hide()),$(".tab-link").on("click",function(){$(".foot-all").hide(),$(".editor").show(),$(".complete").hide(),$(".media").hide(),$(".item-inner").removeClass("item-inner-p"),$(".cancelCollect").show(),"商品"==$(".bdbtm.active").text().trim()&&0==$(".good li").length?$(".no-shop").show():"商店"==$(".bdbtm.active").text().trim()&&0==$(".shop li").length&&$(".no-good").show()}),$(".editor").on("click",function(){$(".editor").hide(),$(".complete").show(),$(".foot-all").show(),$(".media").show(),$(".del_num").text("0");var e=$(".bdbtm.active").text().trim();$("input[type='checkbox']").prop("checked",!1),"商品"==e?($("#tab1 .item-inner").addClass("item-inner-p"),$(".foot-all .foot-btn").addClass("slideInUp"),$(".foot-all .foot-btn").removeClass("slideOutDown"),$(".foot-all .foot-btn").addClass("animated"),$(".good").show(),$("#tab2 .media").hide(),$("#tab1 .cancelCollect").hide()):"商店"==e&&($(".shop").show(),$("#tab2 .item-inner").addClass("item-inner-p"),$("#tab1 .item-inner").addClass("item-inner-r"),$(".foot-all .foot-btn").addClass("slideInUp"),$(".foot-all .foot-btn").removeClass("slideOutDown"),$(".foot-all .foot-btn").addClass("animated"),$("#tab2 .cancelCollect").hide())}),$(".complete").on("click",function(){$(".editor").show(),$(".complete").hide(),$(".foot-all").hide(),"商品"==$(".bdbtm.active").text().trim()?($("#tab1 .item-inner").removeClass("item-inner-p"),$(".foot-all .foot-btn").addClass("slideOutDown"),$(".foot-all .foot-btn").removeClass("slideInUp"),$(".foot-all .foot-btn").addClass("animated"),$("#tab1 .cancelCollect").show()):"商店"==$(".bdbtm.active").text().trim()&&($("#tab2 .item-inner").removeClass("item-inner-p"),$("#tab2 .cancelCollect").show(),$(".shop").show())})});