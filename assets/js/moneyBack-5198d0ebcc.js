function getQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),r=window.location.search.substr(1).match(t);return null!=r?unescape(r[2]):null}function order_urls(){if(-1!=url.indexOf("?")){var e=url.substr(1);new Object;strs=e.split("="),urls=strs[0]}return"order_goods"==urls?"&order_goods_id="+order_gods:"order_id"==urls?"&order_id="+orderId:void 0}var oHeight=$(document).height();$(window).resize(function(){$(document).height()<oHeight?$("#backMoney-btn").css("position","static"):$("#backMoney-btn").css("position","fixed")});var orderId=getQueryString("order_id"),order_gods=getQueryString("order_goods"),status=getQueryString("status"),url=location.search,urls="";new Vue({el:"#moneyBack",data:{imgSrc:[],status:status,imgNum:"最多三张"},methods:{changeImg:function(e){var t=e.target.files||e.dataTransfer.files;t.length&&this.createImage(t[0])},createImage:function(e){var t=new FileReader,r=this;t.onload=function(e){r.imgSrc.push(e.target.result)},t.readAsDataURL(e),this.imgNum=this.imgSrc.length+1+"/3"},remove:function(e){this.imgSrc.splice(e,1),$("#upload").val(""),0==this.imgSrc.length?this.imgNum="最多三张":this.imgNum=this.imgSrc.length+"/3"},sub:function(){var e=this,t=$('input:radio[name="refund_reason"]:checked').val(),r=$('input:radio[name="refund_type"]:checked').val(),n=$('input[name="refund_amount"]').val();void 0==t?layer.open({content:"请选择退款原因",skin:"msg",time:2}):void 0==r&&30==e.status?layer.open({content:"请选择退款类型",skin:"msg",time:2}):""==n?layer.open({content:"请填写退款金额",skin:"msg",time:2}):(layer.open({content:"确认退款将不会返还您已消费的七彩币，您是否继续退款？",btn:["确定","取消"],yes:function(e){layer.close(e);var t=$("form[name=fileForm]"),r={url:baseUrl()+"member.php?r=order&m=refund&token="+token()+order_urls(),type:"post",success:function(e){1==JSON.parse(e).res?(layer.open({content:"提交申请成功",skin:"msg",time:2}),window.location.href="./myOrder-table.html"):layer.open({content:"网络错误，请重试",skin:"msg",time:2})}};t.ajaxSubmit(r)}}),$(".layui-m-anim-scale").addClass("popupTitleBox"),$(".layui-m-layerbtn").addClass("popupBottom"),$(".layui-m-layercont").addClass("popupTitle"),$(".layui-m-layerbtn span[no]").addClass("cancel"),$(".layui-m-layerbtn span[yes]").addClass("sure"))}}});