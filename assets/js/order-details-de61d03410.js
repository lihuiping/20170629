function GetQueryString(a){var e=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(e);return null!=t?unescape(t[2]):null}function transformRequest(a){var e="";for(var t in a)e+=encodeURIComponent(t)+"="+encodeURIComponent(a[t])+"&";return e}var conf=1,orderDetailsList=["../assets/data/order-details.json",baseUrl()+"member.php?r=order&m=orderDetails"],delOrderDetail=["../assets/data/delOrder.json",baseUrl()+"member.php?r=order&m=cancel"],orderPay=["",baseUrl()+"index.php?r=pay&m=orderPay"],orderID=GetQueryString("id"),header={"content-type":"application/x-www-form-urlencoded"},openid=Cache.get("openid"),orderDetails=new Vue({el:"#order-details",data:{orderDetailsList:[],orderDetailsAddr:[],orderDetailsStaA:[],flag:!0,loadingFlag:!0},filters:{odMoneyTit:function(a){return 0==a?"消费￥":1==a?"消费七彩币":void 0},odMoneyTit1:function(a){return 0==a?"花费￥":1==a?"花费七彩币":void 0}},mounted:function(){var a=this;this.showOrderDetails(),setTimeout(function(){a.showBdBtm()},100)},methods:{showOrderDetails:function(a){var e=this;axios.get(orderDetailsList[conf],{params:{token:token(),id:orderID}}).then(function(a){var t=a.data.res,r=a.data.data,o=a.data.data.address,d=a.data.data.statusAction;1==t?(orderDetails.orderDetailsList=r,orderDetails.orderDetailsAddr=o,orderDetails.orderDetailsStaA=d,e.loadingFlag=!1):$.toast("操作失败")})},showBdBtm:function(){"10"==$(".od-content").attr("data_status")&&($(".od-content").css("border-bottom","none"),$(".od-status").addClass("od-addSty"),$(".od-status").css("height","2.5rem"))},delOrder:function(){var a=$(".od-ban").attr("odOId");orderDetails.flag&&layer.open({content:"确定取消订单吗？",btn:["确定","取消"],yes:function(e){axios.get(delOrderDetail[conf],{params:{token:token(),id:a}}).then(function(a){a.data.msg;1==a.data.res?($(".btn-cancelOrder").eq(0).addClass("btn-cancelhui"),$.toast("订单取消成功"),$(".od-box").remove()):$.toast("订单取消失败")}),layer.close(e),orderDetails.flag=!1},no:function(){orderDetails.flag=!0}}),$(".layui-m-anim-scale").addClass("searchAera"),$(".layui-m-layerbtn").addClass("searchTop"),$(".layui-m-layercont").addClass("searchConfirm"),$(".layui-m-layerbtn span[no]").addClass("searchCancel"),$(".layui-m-layerbtn span[yes]").addClass("ok")},refundOder:function(){var a=$(".od-right a:active").parents("li").attr("godid"),e=$(".od-ban").attr("odStatus");window.location.href="moneyBack.html?order_goods="+a+"&status="+e},appraiseOrder:function(){var a=$(".od-right a:active").parents("li").attr("godid");window.location.href="addComment.html?order_goods="+a},coventOrder:function(){var a=[];$(".od-ban").each(function(e,t){var r=$(t).attr("odOId");a.push(r)});var e=a.join(",");openid&&isWenxin?axios.post(orderPay[conf],transformRequest({token:token(),orderIds:e}),{headers:header}).then(function(a){var e=a.data.res,t=a.data.data.orderId,r=(a.data.data.amount,a.data.data.subject),o=a.data.msg;1==e?FUQIANLA.init({appId:"VWT0GaNzbX3Dqesop5zrOg",merchId:"m1610030006",orderId:t,channel:"wx_pay_pub",amount:"0.01",subject:r,notifyUrl:"http://my.shop.7cai.tv/pay.php",extra:{openid:openid,cb:function(){window.location.href="./myOrder-table.html"}}}):layer.open({content:o,skin:"msg",time:2})}):isWenxin&&!openid?$.toast("没有获取到用户ID!"):$.toast("请在微信中支付！")}}});$.init();