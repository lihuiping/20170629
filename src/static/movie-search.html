<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta content="yes" name="apple-mobile-web-app-capable">
		<meta content="yes" name="apple-touch-fullscreen">
		<meta content="telephone=no,email=no" name="format-detection">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta name="description" content="这里是文档模式">
		<meta name="keywords" content="这里是关键词">
		<title>七彩梦视频</title>
		<link rel="stylesheet" href="lib/light7/css/light7.min.css">
		<link rel="stylesheet" href="lib/layer-mobile/need/layer.css" />
		<link rel="stylesheet" href="assets/css/common.css">
		<!--<script type="text/javascript" src="lib/jquery-2.1.1.min.js"></script>-->
		<script type="text/javascript" src="lib/zepto.min.js"></script>
		<script type="text/javascript" src="lib/vue.js"></script>
		<script type="text/javascript" src="lib/axios.min.js"></script>
		<script type='text/javascript' src='lib/layer-mobile/layer.js' charset='utf-8'></script>
	</head>
	<style type="text/css">
		.not-found-video {
			position: static;
			height: 70%;
			margin-top: 0;
			display: none;
		}
		
		#ss-shanchu {
			display: block;
			position: absolute;
			color: #fff;
			right: 3rem;
			display: none;
		}
		
		#sousuo-input {
			width: 88%;
			-webkit-appearance: none;
			font-size: 0.75rem;
			height: 1.55rem;
		}
		
		strong {
			font-weight: 400;
		}
		/*搜索*/
		
		.dy-sousuo {
			padding: .5rem .5rem;
			position: fixed;
		}
		/*.dy-sousuo {
			width: 100%;
			padding: 1rem .5rem;
			font-size: .8rem;
			color: #a4a4a4;
			position: relative;
			background-color: white;
		}*/
		
		.dy-sousuo i {
			color: #fff;
			font-size: .85rem;
			position: absolute;
			/*margin-top: .2rem;*/
			padding: .9rem .4rem .2rem .6rem;
		}
		
		.dy-sousuo input {
			border-radius: 1rem;
			padding: 0!important;
			font-size: .8rem;
			width: 85%;
			border: 1px solid #fff;
			border-style: solid;
			padding-left: 1.8rem;
		}
		
		.sousuo-list {
			background-color: white;
		}
		
		.sousuo-list ul li {
			height: 2rem;
			line-height: 1.9rem;
			padding: .1rem 0;
			border-bottom: 1px solid #ececec;
		}
		
		.sousuo-list a {
			line-height: 1.5rem;
			color: #8a8a8a;
			font-size: .8rem;
			display: block;
			padding: 0.2rem 0 .1rem 0.1rem;
			background: #fff;
			/*border-bottom: 1px solid #d9d9d9;*/
		}
		
		.movieSearchList {
			padding: 0 .5rem;
		}
		
		.clear-record {
			font-size: .7rem;
			color: #8a8a8a;
			width: 100%;
			text-align: center;
			height: 2rem;
			line-height: 2rem;
		}
		
		.clear-record i {
			font-size: .7rem;
			margin-right: .3rem;
		    margin-top: -0.1rem;
		}
		/*  没有找到视频*/
		
		.not-found-video {
			width: 100%;
			text-align: center;
			position: fixed;
			top: 50%;
			margin-top: -5rem;
		}
		
		.not-found-video p {
			font-size: .8rem;
			margin-top: .7rem;
			color: #a0a0a0;
		}
		
		.not-found-video i {
			font-size: 5rem;
			opacity: .2;
		}
		
		#sousuo-quxiao {
			color: #fff;
			position: absolute;
    		top: 42px;
    		right: 12px;
    		font-size: 0.75rem;
		}
	</style>

	<body>
		<div class="page page-current page-inited" id="page-1496732055239">
			<form class="dy-sousuo search-fm" style="height: 3.7rem;padding-top: 1rem;">
					<i class="icon icon-sousuo" id="lb-sousuo"></i>
					<input placeholder="请输入影片名" id="sousuo-input" name="search" />
					<i class="icon icon-shanchuzifu" id="ss-shanchu"></i> &nbsp;
					<span id="sousuo-quxiao">取消</span>
				</form>
			<div class="content znTop">
				<div class="not-found-video">
					<i class="icon icon-shipinqueshen"></i>
					<p>没有找到相关视频</p>
				</div>
				<div class="sousuo-list">
					<ul>
					</ul>
					<div class="clear-record" id="qingkongjilu" style="display: none;">
						<i class="icon icon-shanchu"></i>清空历史记录
					</div>
				</div>
			</div>
		</div>
		<script type="text/javascript" src="lib/hprose.js" charset="utf-8"></script>
		<!--<script type="text/javascript" src="assets/js/other.js" charset="utf-8"></script>-->
		<script type="text/javascript">
			function baseUrl() {
				return 'http://my.shop.7cai.tv/';
			}
			//进入页面刷新
			var Cookie = {
				setCookie: function(name, value, option) {
					var str = name + "=" + escape(value);
					if(option) {
						if(option.expireDays) {
							var date = new Date();
							var ms = option.expireDays * 24 * 3600 * 1000;
							date.setTime(date.getTime() + ms);
							str += "; expires=" + date.toGMTString();
						}
						if(option.path) str += ";path=" + option.path;
						if(option.domain) str += ";domain=" + option.domain;
						if(option.secure) str += ";true";
					}
					document.cookie = str;
				},
				getCookie: function(name) {
					var cookies = document.cookie.split(";");
					for(var i = 0; i < cookies.length; i++) {
						var arr = cookies[i].split("=");
						if(arr[0] == name) {
							return unescape(arr[1]);
						}
					}
					return "";
				},
				delCookie: function(name) {
					this.setCookie(name, "", {
						expireDays: -1
					});
				}
			}
			window.onload = function() {
				if("1" == Cookie.getCookie("diffmaker")) {
					$("#sousuo-input").val("");
					//alert("找到Cookie，我将不再刷新页面，并删除Cookie");  
					Cookie.delCookie("diffmaker");
				} else {
					$("#sousuo-input").val("");
					//alert("没有找到Cookie，我将刷新页面!");  
					Cookie.setCookie("diffmaker", "1", null);
					window.location.reload(true);
				}
			}
			
			$(".not-found-video").show();
			$("#sousuo-quxiao").on("click", function() {
				window.history.go(-1);
			});
			var u = navigator.userAgent;
			var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);
			
			//搜索框输入时状态 
			$("#sousuo-input").on('input', function() {
				//接受后台数据  
				var inVal = $("#sousuo-input").val();
				if(inVal != ''){
					$("#ss-shanchu").show();
					$("#ss-shanchu").click(function() {
						$("#sousuo-input").val("");
						$(".sousuo-list ul").empty();
						$(".not-found-video").hide();
						$(".clear-record").hide();
					})
					$.ajax({
						type: "GET",
//						async: false,
						url: baseUrl() + 'tv/?s=/Api/movie/search/name/<![CDATA[all]>/size/10000', //实际上访问时产生的地址为: ajax.ashx?callbackfun=jsonpCallback&id=10
//						cache: false, //默认值true
						dataType: 'json',
						data: {name:$('input[name=search]').val()},
						success: function(db) {
							if(db.res ==1){
	                            $('.sousuo-list ul').html('');
	                            console.log(db.data.id);
	                            $.each( db.data, function(i, n){
	                                $('.sousuo-list ul').append('<li><a href="movie-content.html?id='+n['id']+'">'+ n['videoname']+'--'+n['id']+'</a></li>');
	                            });
	                            
	                            $(".clear-record").show();
								$(".not-found-video").hide();
	                            $("#qingkongjilu").on("click", function() {
									$(".sousuo-list ul li").remove();
								});
								
                        	}
                        	
                        	
                        	
							/*var json = db;
							var leg = db.data.length;
							console.log(db.data);
							var dataMsg = db.msg;
							
							//console.log(dataMsg);
							if(leg !== 0 && inVal !== "") {
								$.each( db.data, function(i, n){
//	                                $('ul[id=content]').append('<li>'+ n['videoname']+'</li>');
	                                $(".sousuo-list ul").html('<li class="movieSearchList"><a v-for="ls in data" :data-id="ls.id" :href="getTitleHref(ls.id)"  v-cloak>{{ls.videoname}}</a></div>');
	                            });
								var apps = new Vue({
									el: ".sousuo-list",
									data: json,
									methods: {
										getTitleHref: function(val) {
											return 'movie-content.html?id=' + val;
										}
									}
								});
								$(".not-found-video").hide();
								$("#ss-shanchu").show();
							}
	
							if(dataMsg == '失败') {
								$(".not-found-video").show();
							}*/
	
						},
	
						error: function(status) {
							layer.open({
								content: '数据错误',
								skin: 'msg',
								time: 1 //1秒后自动关闭
							});
						}
	
					})
				}else{
					$(".not-found-video").show();
					$(".sousuo-list ul").html('');
				}
			});
		</script>
	</body>

</html>